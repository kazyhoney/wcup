# 2026年FIFAワールドカップ 組分け抽選シミュレーター 要件定義書

**バージョン**: 1.0  
**作成日**: 2025年12月5日

## 1. プロジェクト概要

### 1.1 目的
2026年北米3カ国（アメリカ・メキシコ・カナダ）共催ワールドカップにおける、史上初の48カ国出場フォーマットに対応した組分け抽選シミュレーターを提供する。ユーザーは「応援する国（My Team）」を選択するだけで、複雑なFIFA抽選規定（ポット分け、大陸連盟制約、開催国固定、トップシード分離など）に基づいたシミュレーションを体験し、対戦国、試合日程、移動距離のイメージを可視化することを目的とする。

### 1.2 ターゲットユーザー
- ワールドカップ出場国のサポーター（特に対戦相手や現地観戦計画に関心がある層）
- サッカーメディア関係者（シミュレーション記事作成用）

## 2. システム要件

### 2.1 技術スタック
- **形態**: Webアプリケーション（Single Page Application）
- **フロントエンド**: React.js, TypeScript
- **スタイリング**: Tailwind CSS (レスポンシブデザイン完全対応)
- **デプロイ環境**: Vercel または Netlify 等の静的ホスティング想定
- **データ処理**: クライアントサイド（ブラウザ）でのJavaScript計算処理

## 3. 機能要件

### 3.1 国選択機能（エントリー）
- **UI**: 48の出場国・地域（プレーオフ枠含む）をカード形式またはグリッド形式で表示する。
- **表示要素**: 国旗、国名（日本語/英語）、FIFAランク、所属大陸連盟。
- **検索・フィルタ**: 国名入力による検索、および大陸連盟（UEFA, AFC, CONMEBOL等）による絞り込み機能。
- **アクション**: 任意の国をクリックすることで「My Team」として設定し、シミュレーションを開始するトリガーとする。

### 3.2 抽選ロジック（アルゴリズム詳細）
提供された資料に基づき、以下の優先順位でアルゴリズムを実装する。

1.  **ポット分け定義**: 全48チームをFIFAランク（2025年11月時点）に基づきPot 1〜4に各12チームずつ分類する。
2.  **開催国の固定配置**:
    - メキシコ: グループA 第1ポジション（A1）固定
    - カナダ: グループB 第1ポジション（B1）固定
    - アメリカ: グループD 第1ポジション（D1）固定
3.  **上位シード国の分離（トップ4プロテクト）**:
    - ランキング上位4カ国（スペイン、アルゼンチン、フランス、イングランド）は、準決勝まで相互に対戦しないよう、トーナメントの山（パス）を考慮してグループを割り振る必要がある。
    - ※実装簡易化のため、これら4カ国を「A, B, D以外のグループ」かつ「相互に離れたグループ（例: 異なる色のパス）」に優先的に割り当てるロジックを組み込む。
    - **通常シード（Pot 1）の配置**: 上記以外のPot 1チームを、残りのグループ（C, E〜L）の第1ポジションにランダム配置する。
4.  **Pot 2〜4の配置と制約チェック**: 順次、Pot 2 → 3 → 4 の順でグループへ割り当てる。
    - **【重要】大陸連盟制約 (Confederation Constraint)**:
        - **UEFA（欧州）**: 各グループに最低1チーム、最大2チームまで。
        - **その他（AFC, CAF, CONMEBOL, CONCACAF, OFC）**: 同一グループに同じ連盟の国が入ることは不可。
5.  **プレーオフ枠の扱い**: プレーオフ勝者枠（欧州PO、大陸間PO）についても、潜在的に勝ち上がる可能性がある国の連盟を考慮し、制約違反にならない場所に配置する。
6.  **デッドロック回避（バックトラッキング）**: 抽選の終盤で「入れるグループがない（大陸制約違反になる）」状態に陥った場合、直前の手順に戻ってやり直す、あるいは全体を再計算するリトライ処理を実装する。

### 3.3 結果表示機能
- **ダッシュボード**: 「My Team」が所属するグループを画面最上部に大きく強調表示する。対戦国3カ国の国旗・国名を並列表示。
- **全体ビュー**: グループA〜L（12グループ）の全組み合わせを一覧表示する。各カードにはFIFAランクを表示し、「死の組」などの視認性を高める。

### 3.4 日程・会場詳細表示機能（ロジスティクス）
- **対戦スケジュール**: 割り当てられたグループに基づき、第1節〜第3節の対戦カードを自動生成する。
- **会場マッピング**: 定義された「グループごとの会場割り当てデータ」を参照し、試合ごとの開催都市・スタジアム名を表示する。
    - 例：「第1節 vs ドイツ（会場：SoFiスタジアム / ロサンゼルス）」のように具体的に表示。

## 4. データ要件（マスターデータ）

### 4.1 チームリスト（2025年11月想定ランク準拠）
- **Pot 1**: スペイン, アルゼンチン, フランス, イングランド, ブラジル, ポルトガル, オランダ, ベルギー, ドイツ, アメリカ(Host), メキシコ(Host), カナダ(Host)
- **Pot 2**: クロアチア, モロッコ, コロンビア, ウルグアイ, スイス, 日本, セネガル, イラン, 韓国, エクアドル, オーストリア, オーストラリア
- **Pot 3**: ノルウェー, パナマ, エジプト, アルジェリア, スコットランド, パラグアイ, チュニジア, コートジボワール, ウズベキスタン, カタール, サウジアラビア, 南アフリカ
- **Pot 4**: ヨルダン, カーボベルデ, ガーナ, キュラソー, ハイチ, ニュージーランド, 欧州PO(A), 欧州PO(B), 欧州PO(C), 欧州PO(D), 大陸間PO(1), 大陸間PO(2)

### 4.2 プレーオフ枠定義
- **欧州PO (A-D)**: UEFA扱い
- **大陸間PO 1**: CAF（コンゴ民主） vs [OFC(ニューカレドニア) or CONCACAF(ジャマイカ)] → 全連盟の可能性を考慮、または安全策としてCAF/CONCACAF/OFCが既にいる組を避ける等の重み付けが必要。
- **大陸間PO 2**: AFC（イラク） vs [CONMEBOL(ボリビア) or CONCACAF(スリナム)] → AFC/CONMEBOL/CONCACAFとの同居回避推奨。

### 4.3 会場・日程固定データ
(要件定義書の表を参照)

## 5. UI/UXデザイン仕様

### 5.1 画面遷移フロー
1.  **トップ画面 (Select Team)**
    - ヒーローエリア：大会ロゴと「あなたの国の運命を決める」等のキャッチコピー。
    - チームグリッド：48カ国の国旗パネル。大陸ごとのタブ切り替え（All, Asia, Europe...）があると望ましい。
2.  **抽選演出 (Drawing...)**
    - 0.5〜1.0秒程度のローディングアニメーション。ボールが開く、あるいは国旗がシャッフルされる等の簡易エフェクト。
3.  **結果画面 (Result Dashboard)**
    - **Header**: 「日本（Japan）は グループB に決定！」等のメッセージ。
    - **Main Card**: グループの対戦国3つを表示。
    - **Schedule Section**: 第1戦〜第3戦の日付・会場リスト。
    - **Full Draw**: 下部に全グループ（A-L）の小さなテーブルを表示。
    - **Footer**: 「もう一度抽選する（Reset）」ボタン、SNSシェアボタン。

### 5.2 デザインガイドライン
- **カラーパレット**: 2026年大会のブランドカラー（黒、白、鮮やかな緑や紫のアクセント）を参考にするが、視認性を優先し、ベースはホワイト/ライトグレー、アクセントにネイビー（#1e3a8a）を使用。
- **フォント**: Google Fontsより「Inter」または「Roboto」を使用。数字（順位や日程）は等幅フォントで整列させる。

## 6. 非機能要件
- **パフォーマンス**: 結果表示までのレイテンシは1秒以内とする（計算処理含む）。
- **ロバスト性**: 大陸間連盟の制約により「組分け不能」なパターンに陥った場合、ユーザーにエラーを見せず、バックグラウンドで自動再計算を行う（最大試行回数を設定し、万が一の場合はソフトな制約緩和を行う等のフォールバックを持つ）。
- **共有性**: 結果画面のURLパラメータ（例: ?team=JPN&seed=12345）により、同じ抽選結果を他者に共有できる仕様を検討する（オプション）。
